# IMPLEMENT フェーズ

# ユーザの入力
#$ARGUMENTS

## 目的
構成案に基づく記事の執筆・編集と、**無料ツールのみ**で実行できる品質チェック機能を統合した執筆支援を行う。

## 注意事項
- 常にしっかり考えて段階的に思考すること
- 構成案（PLAN）に忠実に執筆すること
- **CLAUDE.md 記事作成ルール**を厳格に適用すること
- 読みやすさ（段落・文長・見出し）と正確性（一次情報・出典明記）のバランスを保つこと
- 表（Markdownテーブル）や画像（スクショ/図表）を積極活用し、視認性を高めること

## 必要な入力ファイル
- 構成案ファイル（`docs/plan/article_plan_{TIMESTAMP}.md`）
- 参考資料（調査結果ファイルなど）

## タスクに含まれるべき TODO
1. 構成案ファイルの読み込み・解析（目標文字数の確認を含む）
2. テンプレートの適用（YAML フロントマター設定）
3. **概要セクション**の執筆（200文字以内）
4. **詳細セクション**の段階的執筆（目標文字数を考慮）
5. 専門用語の初出に**平易な説明**を追加（必要なら用語集 `docs/glossary.yml` を参照）
6. 視覚的要素（テーブル・画像）の適切な挿入（画像は `assets/` に保存し相対パスで参照）
7. 引用元情報（URL/書誌）の適切な配置（脚注や引用ブロック）
8. **CLAUDE.md ルールの適用確認**（表記・見出し・出典・画像方針）
9. 文体・トーンの一貫性チェック（です/ます or である）
10. **品質チェック**の実施（文字数・見出し数・出典・テーブル/画像の有無）
11. ドラフトの保存（`drafts/draft_{TIMESTAMP}.md`）
12. **修正提案リスト**の生成（箇条書き）
13. 完了通知とファイル出力情報の記録

## 引数仕様
- **plan** (必須): 構成案ファイルパス
- **mode** (オプション): 執筆モード (`new`/`edit`/`final`) デフォルト: `new`
- **quality** (オプション): 品質チェックレベル (`basic`/`standard`/`detailed`) デフォルト: `detailed`
- **output** (オプション): 出力形式 (`draft`/`final`) デフォルト: `draft`

## 出力ファイル
- `drafts/draft_{TIMESTAMP}.md` - 記事ドラフト
- `drafts/quality_check_{TIMESTAMP}.md` - 品質チェック結果

## ドラフトファイル形式
````markdown
---
permalink: /[記事ID]
title: "[記事タイトル]"
link: [引用元URL（該当する場合）]
summary: "[記事要約]"
tags:
  - "#ai-news"
  - "#[追加タグ]"
---

> [!NOTE] 引用元
> [引用元URL1]
> [引用元URL2]（複数ある場合）

# 概要
[200文字以内の要約。何が起きたか、なぜ重要か、誰に影響があるかを簡潔に説明]

# 詳細

## [見出し1]
[本文内容。専門用語には初出時に説明を追加]

### [サブ見出し（必要に応じて）]
[詳細内容]

| 項目 | 説明 | 備考 |
|------|------|------|
| [項目1] | [説明1] | [備考1] |
| [項目2] | [説明2] | [備考2] |

## [見出し2]
[本文内容。読者の疑問に答える形式で展開]

![説明的な代替テキスト](画像URL)
*画像出典: [出典名]*

## [見出し3]
[本文内容。具体例を用いて説明]

# まとめ
[結論と今後の展望。「結局どうすればいいか」を明確に]

> [!IMPORTANT] 免責事項
> この記事は公開情報に基づく解説であり、法的助言ではありません。
````

## 品質チェック結果形式
````markdown
# 品質チェック結果

## チェック日時
YYYY年MM月DD日 HH:MM:SS

## 総合評価
- **スコア**: [数値]/100
- **判定**: [優良/良好/要改善]

## 詳細チェック結果
### CLAUDE.mdルール準拠
- [✓/✗] YAMLフロントマター形式
- [✓/✗] 概要200文字以内
- [✓/✗] 引用元明記
- [✓/✗] 見出し構成

### 文章品質
- [✓/✗] 文体の一貫性
- [✓/✗] 専門用語の説明
- [✓/✗] 論理的な展開
- [✓/✗] 読みやすさ
- [✓/✗] 視覚的要素の適切な使用
- [✓/✗] 目標文字数への適合

### 修正提案
1. **[箇所]**: [修正提案内容]
2. **[箇所]**: [修正提案内容]
3. **[箇所]**: [修正提案内容]

## 統計情報
- **総文字数**: [数値]
- **見出し数**: [数値]
- **専門用語数**: [数値]
- **引用元数**: [数値]
- **テーブル数**: [数値]
- **画像数**: [数値]
````

## 最終出力形式
### 執筆完了の場合
````
status: SUCCESS
next: COMMIT
details: "執筆完了。draft_{TIMESTAMP}.mdに保存。品質スコア: [数値]/100。コミットフェーズへ移行。"
````

### 修正が必要な場合
````
status: NEED_REVISION
next: IMPLEMENT
details: "品質チェックで要改善項目あり。quality_check_{TIMESTAMP}.mdに詳細。修正後再実行。"
````